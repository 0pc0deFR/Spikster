limit_req_zone  zone=perip:10m rate=1r/s;
limit_req_zone  zone=perserver:10m rate=10r/s;
limit_req zone=perip burst=5 nodelay;
limit_req zone=perserver burst=10;
client_body_timeout 10s;
client_header_timeout 10s;
client_max_body_size 256M;

    server {
        client_body_timeout 10s;
        client_header_timeout 10s;
        client_max_body_size 256M;

    /etc/nginx/nginx.conf

    http {
        limit_req_zone $binary_remote_addr zone=one:10m rate=30r/m;

JAIL=/etc/fail2ban/jail.local
sudo unlink JAIL
sudo touch $JAIL
sudo cat > "$JAIL" <<EOF
[DEFAULT]
bantime = 3600
banaction = iptables-multiport

[sshd]
enabled = true
logpath  = /var/log/auth.log

[nginx-req-limit]
enabled = true
filter = nginx-req-limit
action = iptables-multiport[name=ReqLimit, port=”http,https”, protocol=tcp]
logpath = /var/log/nginx/*error.log
findtime = 200
bantime = 2600
maxretry = 20
EOF
